###########################################################################
# OpenIndiana
###########################################################################
- name: openindiana
  type: repository
  desc: OpenIndiana packages
  singular: OpenIndiana package
  family: openindiana
  ruleset: openindiana
  minpackages: 1800
  sources:
    {% for sub in ['hipster', 'hipster-encumbered'] %}
    - name: {{sub}}
      fetcher:
        class: FileFetcher
        url: https://pkg.openindiana.org/{{sub}}/catalog/1/catalog.summary.C
      parser:
        class: OpenIndianaSummaryJsonParser
      subrepo: {{sub}}
    {% endfor %}
  repolinks:
    - desc: OpenIndiana home
      url: https://www.openindiana.org/
    - desc: Hipster package repository home
      url: https://pkg.openindiana.org/hipster/en/index.shtml
    - desc: Hipster-encumbered package repository home
      url: https://pkg.openindiana.org/hipster-encumbered/en/index.shtml
    - desc: GitHub repository
      url: https://github.com/OpenIndiana/oi-userland
   # XXX: fmri is not the same as path in github repo, so most times these don't work
#  packagelinks:
#    - type: PACKAGE_SOURCES
#      url: 'https://github.com/OpenIndiana/oi-userland/tree/oi/hipster/components/{fmri}'
#    - type: PACKAGE_RECIPE
#      url: 'https://github.com/OpenIndiana/oi-userland/blob/oi/hipster/components/{fmri}/Makefile'
#      #
  # but we can fallback to github search
  packagelinks:
    - type: PACKAGE_HOMEPAGE
      url: 'https://github.com/search?q=repo%3AOpenIndiana%2Foi-userland+{srcname|quote}+path%3A**%2FMakefile&type=code'
  groups: [ all, production ]
