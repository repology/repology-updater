###########################################################################
# RPM Fusion Fedora
#
# See https://rpmfusion.org/#Browse_available_packages
###########################################################################

{% macro rpmfusion_fedora(version, minpackages, valid_till) %}
- name: rpmfusion_fedora_{{version}}
  type: repository
  desc: RPM Fusion Fedora {{version}}
  family: fedora
  ruleset: [fedora,rpm]
  minpackages: {{minpackages}}
  valid_till: {{valid_till}}
  sources:
    {% for sub1 in ['free', 'nonfree'] %}
    - name: {{sub1}}-release
      fetcher:
        class: RepodataFetcher
        url: https://download1.rpmfusion.org/{{sub1}}/fedora/releases/{{version}}/Everything/source/SRPMS/
      parser:
        class: RepodataParser
        vertags: fc
      subrepo: {{sub1}}/release
    {% for sub2 in ['updates', 'updates-testing', 'tainted'] %}
    - name: {{sub1}}-{{sub2}}
      fetcher:
        class: RepodataFetcher
        url: https://download1.rpmfusion.org/{{sub1}}/fedora/{{sub2|replace('-','/')}}/{{version}}/SRPMS/
      parser:
        class: RepodataParser
        vertags: fc
      subrepo: {{sub1}}/{{sub2}}
    {% endfor %}
    {% endfor %}
  repolinks:
    - desc: RPM Fusion home
      url: https://rpmfusion.org/
  packagelinks:
    - type: PACKAGE_SOURCES
      url: https://github.com/rpmfusion/{srcname}/tree/f{{version}}
    - type: PACKAGE_RECIPE
      url: https://github.com/rpmfusion/{srcname}/blob/f{{version}}/{srcname}.spec
    - type: PACKAGE_RECIPE_RAW
      url: https://raw.githubusercontent.com/rpmfusion/{srcname}/f{{version}}/{srcname}.spec
  groups: [ all, production, rpmfusion ]
{% endmacro %}

{{ rpmfusion_fedora(39, minpackages=300, valid_till='2024-11-26') }}
{{ rpmfusion_fedora(40, minpackages=300, valid_till='2025-05-13') }}
{{ rpmfusion_fedora(41, minpackages=300, valid_till='2025-11-19') }}
{{ rpmfusion_fedora(42, minpackages=300, valid_till='2026-05-13') }}
{{ rpmfusion_fedora(43, minpackages=300, valid_till='2026-12-02') }}

- name: rpmfusion_fedora_rawhide
  type: repository
  desc: RPM Fusion Fedora Rawhide
  family: fedora
  ruleset: [fedora,rpm]
  minpackages: 250
  sources:
    {% for sub1 in ['free', 'nonfree'] %}
    {% set repo_url = 'https://download1.rpmfusion.org/' + sub1 + '/fedora/development/rawhide/Everything/source/SRPMS/' %}
    - name: {{sub1}}-development
      fetcher:
        class: RepodataFetcher
        url: {{repo_url}}
      parser:
        class: RepodataParser
        vertags: fc
      subrepo: {{sub1}}/release
      packagelinks:
        - type: PACKAGE_HOMEPAGE
          url: {{repo_url}}/repoview/{srcname}.html
    {% endfor %}
  repolinks:
    - desc: RPM Fusion home
      url: https://rpmfusion.org/
  packagelinks:
    - type: PACKAGE_SOURCES
      url: https://github.com/rpmfusion/{srcname}
    - type: PACKAGE_RECIPE
      url: https://github.com/rpmfusion/{srcname}/blob/master/{srcname}.spec
    - type: PACKAGE_RECIPE_RAW
      url: https://raw.githubusercontent.com/rpmfusion/{srcname}/master/{srcname}.spec
  groups: [ all, production, rpmfusion ]

###########################################################################
# RPM Fusion EL
###########################################################################
{% macro rpmfusion_el(version, minpackages, valid_till=None) %}
- name: rpmfusion_el_{{version}}
  type: repository
  desc: RPM Fusion EL {{version}}
  family: fedora
  ruleset: [fedora,rpm]
  minpackages: {{minpackages}}
  {% if valid_till %}
  valid_till: {{valid_till}}
  {% endif %}
  sources:
    {% for sub1 in ['free', 'nonfree'] %}
    {% for sub2 in ['updates', 'updates-testing'] %}
    - name: {{sub1}}-{{sub2}}
      fetcher:
        class: RepodataFetcher
        url: https://download1.rpmfusion.org/{{sub1}}/el/{{sub2|replace('-','/')}}/{{version}}/SRPMS/
      parser:
        class: RepodataParser
        vertags: el
      subrepo: {{sub1}}/{{sub2}}
    {% endfor %}
    {% endfor %}
  repolinks:
    - desc: RPM Fusion home
      url: https://rpmfusion.org/
  packagelinks:
    - type: PACKAGE_SOURCES
      url: https://github.com/rpmfusion/{srcname}/tree/el{{version}}
    - type: PACKAGE_RECIPE
      url: https://github.com/rpmfusion/{srcname}/blob/el{{version}}/{srcname}.spec
    - type: PACKAGE_RECIPE_RAW
      url: https://raw.githubusercontent.com/rpmfusion/{srcname}/el{{version}}/{srcname}.spec
  groups: [ all, production, rpmfusion ]
{% endmacro %}

{{ rpmfusion_el(6, minpackages=50,  valid_till='2020-11-30') }}
{{ rpmfusion_el(7, minpackages=100, valid_till='2024-06-30') }}
{{ rpmfusion_el(8, minpackages=50) }}
{{ rpmfusion_el(9, minpackages=50) }}
{{ rpmfusion_el(10, minpackages=50) }}
